---
title: "Proyecto 1 - Miner√≠a de datos"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(haven)
library(dplyr)


data_matrimonios_2021 <- read_sav("matrimonios_2021.sav")
#View(data_matrimonios_2021)

data_matrimonios_2020 <- read_sav("matrimonios_2020.sav")
#View(data_matrimonios_2020)

data_matrimonios_2019 <- read_sav("matrimonios_2019.sav")
#View(data_matrimonios_2019)

data_matrimonios_2018 <- read_sav("matrimonios_2018.sav")
#View(data_matrimonios_2018)

data_matrimonios_2017 <- read_sav("matrimonios_2017.sav")
#View(data_matrimonios_2017)

data_matrimonios_2016 <- read_sav("matrimonios_2016.sav")
#View(data_matrimonios_2016)

data_matrimonios_2015 <- read_sav("matrimonios_2015.sav")
#View(data_matrimonios_2015)

data_matrimonios_2014 <- read_sav("matrimonios_2014.sav")
#View(data_matrimonios_2014)

data_matrimonios_2013 <- read_sav("matrimonios_2013.sav")
#View(data_matrimonios_2013)

data_matrimonios_2012 <- read_sav("matrimonios_2012.sav")
#View(data_matrimonios_2012)

data_matrimonios_2011 <- read_sav("matrimonios_2011.sav")
#View(data_matrimonios_2011)

data_matrimonios_2010 <- read_sav("matrimonios_2010.sav")
#View(data_matrimonios_2010)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2010$Ocuhom <- case_when(
  substr(data_matrimonios_2010$Ocuhom, 1, 2) %in% categorias ~ substr(data_matrimonios_2010$Ocuhom, 1, 2),
  substr(data_matrimonios_2010$Ocuhom, 1, 2) == "53" ~ "51",
  substr(data_matrimonios_2010$Ocuhom, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2010$Ocuhom, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2010$Ocuhom)
```

```{r}
unique(data_matrimonios_2010$Ocuhom)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2010$Ocumuj <- case_when(
  substr(data_matrimonios_2010$Ocumuj, 1, 2) %in% categorias ~ substr(data_matrimonios_2010$Ocumuj, 1, 2),
  substr(data_matrimonios_2010$Ocumuj, 1, 2) == "53" ~ "51",
  substr(data_matrimonios_2010$Ocumuj, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2010$Ocumuj, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2010$Ocumuj)
```

```{r}
unique(data_matrimonios_2010$Ocumuj)
#View(data_matrimonios_2010)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2011$Ocuhom <- case_when(
  substr(data_matrimonios_2011$Ocuhom, 1, 2) %in% categorias ~ substr(data_matrimonios_2011$Ocuhom, 1, 2),
  substr(data_matrimonios_2011$Ocuhom, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2011$Ocuhom, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2011$Ocuhom)
```

```{r}
unique(data_matrimonios_2011$Ocuhom)
#View(data_matrimonios_2010)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2011$Ocumuj <- case_when(
  substr(data_matrimonios_2011$Ocumuj, 1, 2) %in% categorias ~ substr(data_matrimonios_2011$Ocumuj, 1, 2),
  substr(data_matrimonios_2011$Ocumuj, 1, 2) == "05" ~ "NEOG",
  substr(data_matrimonios_2011$Ocumuj, 1, 2) == "53" ~ "51",
  substr(data_matrimonios_2011$Ocumuj, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2011$Ocumuj, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2011$Ocumuj)
```

```{r}
unique(data_matrimonios_2011$Ocumuj)
#View(data_matrimonios_2010)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2012$OCUHOM <- case_when(
  substr(data_matrimonios_2012$OCUHOM, 1, 2) %in% categorias ~ substr(data_matrimonios_2012$OCUHOM, 1, 2),
  substr(data_matrimonios_2012$OCUHOM, 1, 2) == "29" ~ "NEOG",
  substr(data_matrimonios_2012$OCUHOM, 1, 2) == "76" ~ "NEOG",
  substr(data_matrimonios_2012$OCUHOM, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2012$OCUHOM, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2012$OCUHOM)
```

```{r}
unique(data_matrimonios_2012$OCUHOM)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2012$OCUMUJ <- case_when(
  substr(data_matrimonios_2012$OCUMUJ, 1, 2) %in% categorias ~ substr(data_matrimonios_2012$OCUMUJ, 1, 2),
  substr(data_matrimonios_2012$OCUMUJ, 1, 2) == "53" ~ "51",
  substr(data_matrimonios_2012$OCUMUJ, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2012$OCUMUJ, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2012$OCUMUJ)
```

```{r}
unique(data_matrimonios_2012$OCUMUJ)
```



```{r}
campos_2010_h <- colnames(data_matrimonios_2010)
campos_2010_h[campos_2010_h == "Ocuhom"] <- "CIUOHOM"
colnames(data_matrimonios_2010) <- campos_2010_h
```

```{r}
campos_2010_m <- colnames(data_matrimonios_2010)
campos_2010_m[campos_2010_m == "Ocumuj"] <- "CIUOMUJ"
colnames(data_matrimonios_2010) <- campos_2010_m
```

```{r}
campos_2011_h <- colnames(data_matrimonios_2011)
campos_2011_h[campos_2011_h == "Ocuhom"] <- "CIUOHOM"
colnames(data_matrimonios_2011) <- campos_2011_h
```

```{r}
campos_2011_m <- colnames(data_matrimonios_2011)
campos_2011_m[campos_2011_m == "Ocumuj"] <- "CIUOMUJ"
colnames(data_matrimonios_2011) <- campos_2011_m
```

```{r}
campos_2012_h <- colnames(data_matrimonios_2012)
campos_2012_h[campos_2012_h == "OCUHOM"] <- "CIUOHOM"
colnames(data_matrimonios_2012) <- campos_2012_h
```

```{r}
campos_2012_m <- colnames(data_matrimonios_2012)
campos_2012_m[campos_2012_m == "OCUMUJ"] <- "CIUOMUJ"
colnames(data_matrimonios_2012) <- campos_2012_m
```


```{r}
data_matrimonios_2013$PUEHOM <- case_when(
  data_matrimonios_2013$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2013$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2013$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2013$PUEHOM)
```

```{r}
data_matrimonios_2014$PUEHOM <- case_when(
  data_matrimonios_2014$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2014$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2014$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2014$PUEHOM)
```

```{r}
data_matrimonios_2015$PUEHOM <- case_when(
  data_matrimonios_2015$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2015$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2015$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2015$PUEHOM)
```

```{r}
data_matrimonios_2016$PUEHOM <- case_when(
  data_matrimonios_2016$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2016$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2016$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2016$PUEHOM)
```

```{r}
data_matrimonios_2017$PUEHOM <- case_when(
  data_matrimonios_2017$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2017$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2017$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2017$PUEHOM)
```


```{r}
data_matrimonios_2018$PUEHOM <- case_when(
  data_matrimonios_2018$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2018$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2018$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2018$PUEHOM)
```

```{r}
data_matrimonios_2019$PUEHOM <- case_when(
  data_matrimonios_2019$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2019$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2019$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2019$PUEHOM)
```

```{r}
data_matrimonios_2020$PUEHOM <- case_when(
  data_matrimonios_2020$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2020$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2020$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2020$PUEHOM)
```

```{r}
data_matrimonios_2021$PUEHOM <- case_when(
  data_matrimonios_2021$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2021$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2021$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2021$PUEHOM)
```


```{r}
data_matrimonios_2013$PUEMUJ <- case_when(
  data_matrimonios_2013$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2013$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2013$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2013$PUEMUJ)
```

```{r}
data_matrimonios_2014$PUEMUJ <- case_when(
  data_matrimonios_2014$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2014$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2014$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2014$PUEMUJ)
```

```{r}
data_matrimonios_2015$PUEMUJ <- case_when(
  data_matrimonios_2015$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2015$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2015$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2015$PUEMUJ)
```

```{r}
data_matrimonios_2016$PUEMUJ <- case_when(
  data_matrimonios_2016$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2016$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2016$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2016$PUEMUJ)
```

```{r}
data_matrimonios_2017$PUEMUJ <- case_when(
  data_matrimonios_2017$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2017$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2017$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2017$PUEMUJ)
```


```{r}
data_matrimonios_2018$PUEMUJ <- case_when(
  data_matrimonios_2018$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2018$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2018$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2018$PUEMUJ)
```

```{r}
data_matrimonios_2019$PUEMUJ <- case_when(
  data_matrimonios_2019$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2019$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2019$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2019$PUEMUJ)
```

```{r}
data_matrimonios_2020$PUEMUJ <- case_when(
  data_matrimonios_2020$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2020$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2020$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2020$PUEMUJ)
```

```{r}
data_matrimonios_2021$PUEMUJ <- case_when(
  data_matrimonios_2021$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2021$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2021$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2021$PUEMUJ)
```











