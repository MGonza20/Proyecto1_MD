---
title: "Proyecto 1 - Minería de datos"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(haven)
library(dplyr)


data_matrimonios_2021 <- read_sav("matrimonio2021.sav")
#View(data_matrimonios_2021)

data_matrimonios_2020 <- read_sav("matrimonio2020.sav")
#View(data_matrimonios_2020)

data_matrimonios_2019 <- read_sav("matrimonio2019.sav")
#View(data_matrimonios_2019)

data_matrimonios_2018 <- read_sav("matrimonio2018.sav")
#View(data_matrimonios_2018)

data_matrimonios_2017 <- read_sav("matrimonio2017.sav")
#View(data_matrimonios_2017)

data_matrimonios_2016 <- read_sav("matrimonio2016.sav")
#View(data_matrimonios_2016)

data_matrimonios_2015 <- read_sav("matrimonio2015.sav")
#View(data_matrimonios_2015)

data_matrimonios_2014 <- read_sav("matrimonio2014.sav")
#View(data_matrimonios_2014)

data_matrimonios_2013 <- read_sav("matrimonio2013.sav")
#View(data_matrimonios_2013)

data_matrimonios_2012 <- read_sav("matrimonio2012.sav")
#View(data_matrimonios_2012)

data_matrimonios_2011 <- read_sav("matrimonio2011.sav")
#View(data_matrimonios_2011)

data_matrimonios_2010 <- read_sav("matrimonio2010.sav")
#View(data_matrimonios_2010)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2010$Ocuhom <- case_when(
  substr(data_matrimonios_2010$Ocuhom, 1, 2) %in% categorias ~ substr(data_matrimonios_2010$Ocuhom, 1, 2),
  substr(data_matrimonios_2010$Ocuhom, 1, 2) == "53" ~ "51",
  substr(data_matrimonios_2010$Ocuhom, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2010$Ocuhom, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2010$Ocuhom)

data_matrimonios_2010$Ocuhom <- as.character(data_matrimonios_2010$Ocuhom)
```

```{r}
#unique(data_matrimonios_2010$Ocuhom)
#class(data_matrimonios_2010$Ocuhom)

```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2010$Ocumuj <- case_when(
  substr(data_matrimonios_2010$Ocumuj, 1, 2) %in% categorias ~ substr(data_matrimonios_2010$Ocumuj, 1, 2),
  substr(data_matrimonios_2010$Ocumuj, 1, 2) == "53" ~ "51",
  substr(data_matrimonios_2010$Ocumuj, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2010$Ocumuj, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2010$Ocumuj)

data_matrimonios_2010$Ocumuj <- as.character(data_matrimonios_2010$Ocumuj)
```

```{r}
#unique(data_matrimonios_2010$Ocumuj)
#View(data_matrimonios_2010)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2011$Ocuhom <- case_when(
  substr(data_matrimonios_2011$Ocuhom, 1, 2) %in% categorias ~ substr(data_matrimonios_2011$Ocuhom, 1, 2),
  substr(data_matrimonios_2011$Ocuhom, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2011$Ocuhom, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2011$Ocuhom)

data_matrimonios_2011$Ocuhom <- as.character(data_matrimonios_2011$Ocuhom)
```

```{r}
#unique(data_matrimonios_2011$Ocuhom)
#View(data_matrimonios_2010)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2011$Ocumuj <- case_when(
  substr(data_matrimonios_2011$Ocumuj, 1, 2) %in% categorias ~ substr(data_matrimonios_2011$Ocumuj, 1, 2),
  substr(data_matrimonios_2011$Ocumuj, 1, 2) == "05" ~ "NEOG",
  substr(data_matrimonios_2011$Ocumuj, 1, 2) == "53" ~ "51",
  substr(data_matrimonios_2011$Ocumuj, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2011$Ocumuj, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2011$Ocumuj)

data_matrimonios_2011$Ocumuj <- as.character(data_matrimonios_2011$Ocumuj)
```

```{r}
#unique(data_matrimonios_2011$Ocumuj)
#View(data_matrimonios_2010)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2012$OCUHOM <- case_when(
  substr(data_matrimonios_2012$OCUHOM, 1, 2) %in% categorias ~ substr(data_matrimonios_2012$OCUHOM, 1, 2),
  substr(data_matrimonios_2012$OCUHOM, 1, 2) == "29" ~ "NEOG",
  substr(data_matrimonios_2012$OCUHOM, 1, 2) == "76" ~ "NEOG",
  substr(data_matrimonios_2012$OCUHOM, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2012$OCUHOM, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2012$OCUHOM)

data_matrimonios_2012$OCUHOM <- as.character(data_matrimonios_2012$OCUHOM)
```

```{r}
#unique(data_matrimonios_2012$OCUHOM)
```


```{r}
categorias <- c("01", "03", "11", "12", "13", "14", "21", "22", "23", "24", "25", "26", "31", "32", "33", "34", "35", "41", "42", "43", "44", "51", "52", "54", "61", "62", "71", "72", "73", "74", "75", "81", "82", "83", "91", "92", "93", "94", "95", "96")

data_matrimonios_2012$OCUMUJ <- case_when(
  substr(data_matrimonios_2012$OCUMUJ, 1, 2) %in% categorias ~ substr(data_matrimonios_2012$OCUMUJ, 1, 2),
  substr(data_matrimonios_2012$OCUMUJ, 1, 2) == "53" ~ "51",
  substr(data_matrimonios_2012$OCUMUJ, 1, 2) == "97" ~ "NEOG",
  substr(data_matrimonios_2012$OCUMUJ, 1, 2) == "99" ~ "IGNORADO",
  TRUE ~ data_matrimonios_2012$OCUMUJ)

data_matrimonios_2012$OCUMUJ <- as.character(data_matrimonios_2012$OCUMUJ)
```

```{r}
#unique(data_matrimonios_2012$OCUMUJ)
```



```{r}
campos_2010_h <- colnames(data_matrimonios_2010)
campos_2010_h[campos_2010_h == "Ocuhom"] <- "CIUOHOM"
colnames(data_matrimonios_2010) <- campos_2010_h
```

```{r}
campos_2010_m <- colnames(data_matrimonios_2010)
campos_2010_m[campos_2010_m == "Ocumuj"] <- "CIUOMUJ"
colnames(data_matrimonios_2010) <- campos_2010_m
```

```{r}
campos_2011_h <- colnames(data_matrimonios_2011)
campos_2011_h[campos_2011_h == "Ocuhom"] <- "CIUOHOM"
colnames(data_matrimonios_2011) <- campos_2011_h
```

```{r}
campos_2011_m <- colnames(data_matrimonios_2011)
campos_2011_m[campos_2011_m == "Ocumuj"] <- "CIUOMUJ"
colnames(data_matrimonios_2011) <- campos_2011_m
```

```{r}
campos_2012_h <- colnames(data_matrimonios_2012)
campos_2012_h[campos_2012_h == "OCUHOM"] <- "CIUOHOM"
colnames(data_matrimonios_2012) <- campos_2012_h
```

```{r}
campos_2012_m <- colnames(data_matrimonios_2012)
campos_2012_m[campos_2012_m == "OCUMUJ"] <- "CIUOMUJ"
colnames(data_matrimonios_2012) <- campos_2012_m
```


```{r}
data_matrimonios_2013$PUEHOM <- case_when(
  data_matrimonios_2013$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2013$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2013$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2013$PUEHOM)
```

```{r}
data_matrimonios_2014$PUEHOM <- case_when(
  data_matrimonios_2014$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2014$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2014$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2014$PUEHOM)
```

```{r}
data_matrimonios_2015$PUEHOM <- case_when(
  data_matrimonios_2015$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2015$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2015$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2015$PUEHOM)
```

```{r}
data_matrimonios_2016$PUEHOM <- case_when(
  data_matrimonios_2016$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2016$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2016$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2016$PUEHOM)
```

```{r}
data_matrimonios_2017$PUEHOM <- case_when(
  data_matrimonios_2017$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2017$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2017$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2017$PUEHOM)
```


```{r}
data_matrimonios_2018$PUEHOM <- case_when(
  data_matrimonios_2018$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2018$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2018$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2018$PUEHOM)
```

```{r}
data_matrimonios_2019$PUEHOM <- case_when(
  data_matrimonios_2019$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2019$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2019$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2019$PUEHOM)
```

```{r}
data_matrimonios_2020$PUEHOM <- case_when(
  data_matrimonios_2020$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2020$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2020$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2020$PUEHOM)
```

```{r}
data_matrimonios_2021$PUEHOM <- case_when(
  data_matrimonios_2021$PUEHOM %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2021$PUEHOM %in% c(4, 5) ~ 2, 
  data_matrimonios_2021$PUEHOM == 9 ~ 9, 
  TRUE ~ data_matrimonios_2021$PUEHOM)
```


```{r}
data_matrimonios_2013$PUEMUJ <- case_when(
  data_matrimonios_2013$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2013$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2013$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2013$PUEMUJ)
```

```{r}
data_matrimonios_2014$PUEMUJ <- case_when(
  data_matrimonios_2014$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2014$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2014$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2014$PUEMUJ)
```

```{r}
data_matrimonios_2015$PUEMUJ <- case_when(
  data_matrimonios_2015$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2015$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2015$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2015$PUEMUJ)
```

```{r}
data_matrimonios_2016$PUEMUJ <- case_when(
  data_matrimonios_2016$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2016$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2016$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2016$PUEMUJ)
```

```{r}
data_matrimonios_2017$PUEMUJ <- case_when(
  data_matrimonios_2017$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2017$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2017$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2017$PUEMUJ)
```


```{r}
data_matrimonios_2018$PUEMUJ <- case_when(
  data_matrimonios_2018$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2018$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2018$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2018$PUEMUJ)
```

```{r}
data_matrimonios_2019$PUEMUJ <- case_when(
  data_matrimonios_2019$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2019$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2019$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2019$PUEMUJ)
```

```{r}
data_matrimonios_2020$PUEMUJ <- case_when(
  data_matrimonios_2020$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2020$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2020$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2020$PUEMUJ)
```

```{r}
data_matrimonios_2021$PUEMUJ <- case_when(
  data_matrimonios_2021$PUEMUJ %in% c(1, 2, 3) ~ 1, 
  data_matrimonios_2021$PUEMUJ %in% c(4, 5) ~ 2, 
  data_matrimonios_2021$PUEMUJ == 9 ~ 9, 
  TRUE ~ data_matrimonios_2021$PUEMUJ)
```



```{r}
campos_2010_ph <- colnames(data_matrimonios_2010)
campos_2010_ph[campos_2010_ph == "Gethom"] <- "GETHOM"
colnames(data_matrimonios_2010) <- campos_2010_ph
```

```{r}
campos_2011_ph <- colnames(data_matrimonios_2011)
campos_2011_ph[campos_2011_ph == "Gethom"] <- "GETHOM"
colnames(data_matrimonios_2011) <- campos_2011_ph
```

```{r}
campos_2013_ph <- colnames(data_matrimonios_2013)
campos_2013_ph[campos_2013_ph == "PUEHOM"] <- "GETHOM"
colnames(data_matrimonios_2013) <- campos_2013_ph
```

```{r}
campos_2014_ph <- colnames(data_matrimonios_2014)
campos_2014_ph[campos_2014_ph == "PUEHOM"] <- "GETHOM"
colnames(data_matrimonios_2014) <- campos_2014_ph
```

```{r}
campos_2015_ph <- colnames(data_matrimonios_2015)
campos_2015_ph[campos_2015_ph == "PUEHOM"] <- "GETHOM"
colnames(data_matrimonios_2015) <- campos_2015_ph
```

```{r}
campos_2016_ph <- colnames(data_matrimonios_2016)
campos_2016_ph[campos_2016_ph == "PUEHOM"] <- "GETHOM"
colnames(data_matrimonios_2016) <- campos_2016_ph
```

```{r}
campos_2017_ph <- colnames(data_matrimonios_2017)
campos_2017_ph[campos_2017_ph == "PUEHOM"] <- "GETHOM"
colnames(data_matrimonios_2017) <- campos_2017_ph
```

```{r}
campos_2018_ph <- colnames(data_matrimonios_2018)
campos_2018_ph[campos_2018_ph == "PUEHOM"] <- "GETHOM"
colnames(data_matrimonios_2018) <- campos_2018_ph
```

```{r}
campos_2019_ph <- colnames(data_matrimonios_2019)
campos_2019_ph[campos_2019_ph == "PUEHOM"] <- "GETHOM"
colnames(data_matrimonios_2019) <- campos_2019_ph
```

```{r}
campos_2020_ph <- colnames(data_matrimonios_2020)
campos_2020_ph[campos_2020_ph == "PUEHOM"] <- "GETHOM"
colnames(data_matrimonios_2020) <- campos_2020_ph
```

```{r}
campos_2021_ph <- colnames(data_matrimonios_2021)
campos_2021_ph[campos_2021_ph == "PUEHOM"] <- "GETHOM"
colnames(data_matrimonios_2021) <- campos_2021_ph
```



```{r}
campos_2010_pm <- colnames(data_matrimonios_2010)
campos_2010_pm[campos_2010_pm == "Getmuj"] <- "GETMUJ"
colnames(data_matrimonios_2010) <- campos_2010_pm
```

```{r}
campos_2011_pm <- colnames(data_matrimonios_2011)
campos_2011_pm[campos_2011_pm == "Getmuj"] <- "GETMUJ"
colnames(data_matrimonios_2011) <- campos_2011_pm
```

```{r}
campos_2013_pm <- colnames(data_matrimonios_2013)
campos_2013_pm[campos_2013_pm == "PUEMUJ"] <- "GETMUJ"
colnames(data_matrimonios_2013) <- campos_2013_pm
```

```{r}
campos_2014_pm <- colnames(data_matrimonios_2014)
campos_2014_pm[campos_2014_pm == "PUEMUJ"] <- "GETMUJ"
colnames(data_matrimonios_2014) <- campos_2014_pm
```

```{r}
campos_2015_pm <- colnames(data_matrimonios_2015)
campos_2015_pm[campos_2015_pm == "PUEMUJ"] <- "GETMUJ"
colnames(data_matrimonios_2015) <- campos_2015_pm
```

```{r}
campos_2016_pm <- colnames(data_matrimonios_2016)
campos_2016_pm[campos_2016_pm == "PUEMUJ"] <- "GETMUJ"
colnames(data_matrimonios_2016) <- campos_2016_pm
```

```{r}
campos_2017_pm <- colnames(data_matrimonios_2017)
campos_2017_pm[campos_2017_pm == "PUEMUJ"] <- "GETMUJ"
colnames(data_matrimonios_2017) <- campos_2017_pm
```

```{r}
campos_2018_pm <- colnames(data_matrimonios_2018)
campos_2018_pm[campos_2018_pm == "PUEMUJ"] <- "GETMUJ"
colnames(data_matrimonios_2018) <- campos_2018_pm
```

```{r}
campos_2019_pm <- colnames(data_matrimonios_2019)
campos_2019_pm[campos_2019_pm == "PUEMUJ"] <- "GETMUJ"
colnames(data_matrimonios_2019) <- campos_2019_pm
```

```{r}
campos_2020_pm <- colnames(data_matrimonios_2020)
campos_2020_pm[campos_2020_pm == "PUEMUJ"] <- "GETMUJ"
colnames(data_matrimonios_2020) <- campos_2020_pm
```

```{r}
campos_2021_pm <- colnames(data_matrimonios_2021)
campos_2021_pm[campos_2021_pm == "PUEMUJ"] <- "GETMUJ"
colnames(data_matrimonios_2021) <- campos_2021_pm
```


```{r}
colnames(data_matrimonios_2010) <- toupper(colnames(data_matrimonios_2010))
colnames(data_matrimonios_2011) <- toupper(colnames(data_matrimonios_2011))
colnames(data_matrimonios_2012) <- toupper(colnames(data_matrimonios_2012))
```

```{r}
if ("AÑOOCU" %in% colnames(data_matrimonios_2010)) { data_matrimonios_2010 <- data_matrimonios_2010[, -which(colnames(data_matrimonios_2010) == "AÑOOCU")]}

if ("AÑOOCU" %in% colnames(data_matrimonios_2011)) { data_matrimonios_2011 <- data_matrimonios_2011[, -which(colnames(data_matrimonios_2011) == "AÑOOCU")]}

if ("AÑOOCU" %in% colnames(data_matrimonios_2015)) { data_matrimonios_2015 <- data_matrimonios_2015[, -which(colnames(data_matrimonios_2015) == "AÑOOCU")]}

if ("AÑOOCU" %in% colnames(data_matrimonios_2016)) { data_matrimonios_2016 <- data_matrimonios_2016[, -which(colnames(data_matrimonios_2016) == "AÑOOCU")]}

if ("AÑOOCU" %in% colnames(data_matrimonios_2017)) { data_matrimonios_2017 <- data_matrimonios_2017[, -which(colnames(data_matrimonios_2017) == "AÑOOCU")]}

if ("AÑOOCU" %in% colnames(data_matrimonios_2018)) { data_matrimonios_2018 <- data_matrimonios_2018[, -which(colnames(data_matrimonios_2018) == "AÑOOCU")]}

if ("AÑOOCU" %in% colnames(data_matrimonios_2019)) { data_matrimonios_2019 <- data_matrimonios_2019[, -which(colnames(data_matrimonios_2019) == "AÑOOCU")]}

if ("AÑOOCU" %in% colnames(data_matrimonios_2020)) { data_matrimonios_2020 <- data_matrimonios_2020[, -which(colnames(data_matrimonios_2020) == "AÑOOCU")]}

if ("AÑOOCU" %in% colnames(data_matrimonios_2021)) { data_matrimonios_2021 <- data_matrimonios_2021[, -which(colnames(data_matrimonios_2021) == "AÑOOCU")]}
```

```{r}
if ("NUNUHO" %in% colnames(data_matrimonios_2015)) { data_matrimonios_2015 <- data_matrimonios_2015[, -which(colnames(data_matrimonios_2015) == "NUNUHO")]}

if ("NUNUHO" %in% colnames(data_matrimonios_2016)) { data_matrimonios_2016 <- data_matrimonios_2016[, -which(colnames(data_matrimonios_2016) == "NUNUHO")]}

if ("NUNUHO" %in% colnames(data_matrimonios_2017)) { data_matrimonios_2017 <- data_matrimonios_2017[, -which(colnames(data_matrimonios_2017) == "NUNUHO")]}

if ("NUNUHO" %in% colnames(data_matrimonios_2018)) { data_matrimonios_2018 <- data_matrimonios_2018[, -which(colnames(data_matrimonios_2018) == "NUNUHO")]}

if ("NUNUHO" %in% colnames(data_matrimonios_2019)) { data_matrimonios_2019 <- data_matrimonios_2019[, -which(colnames(data_matrimonios_2019) == "NUNUHO")]}

if ("NUNUHO" %in% colnames(data_matrimonios_2020)) { data_matrimonios_2020 <- data_matrimonios_2020[, -which(colnames(data_matrimonios_2020) == "NUNUHO")]}

if ("NUNUHO" %in% colnames(data_matrimonios_2021)) { data_matrimonios_2021 <- data_matrimonios_2021[, -which(colnames(data_matrimonios_2021) == "NUNUHO")]}
```

```{r}
if ("NUNUMU" %in% colnames(data_matrimonios_2015)) { data_matrimonios_2015 <- data_matrimonios_2015[, -which(colnames(data_matrimonios_2015) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2016)) { data_matrimonios_2016 <- data_matrimonios_2016[, -which(colnames(data_matrimonios_2016) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2017)) { data_matrimonios_2017 <- data_matrimonios_2017[, -which(colnames(data_matrimonios_2017) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2018)) { data_matrimonios_2018 <- data_matrimonios_2018[, -which(colnames(data_matrimonios_2018) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2019)) { data_matrimonios_2019 <- data_matrimonios_2019[, -which(colnames(data_matrimonios_2019) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2020)) { data_matrimonios_2020 <- data_matrimonios_2020[, -which(colnames(data_matrimonios_2020) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2021)) { data_matrimonios_2021 <- data_matrimonios_2021[, -which(colnames(data_matrimonios_2021) == "NUNUMU")]}
```


```{r}
if ("NUNUMU" %in% colnames(data_matrimonios_2015)) { data_matrimonios_2015 <- data_matrimonios_2015[, -which(colnames(data_matrimonios_2015) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2016)) { data_matrimonios_2016 <- data_matrimonios_2016[, -which(colnames(data_matrimonios_2016) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2017)) { data_matrimonios_2017 <- data_matrimonios_2017[, -which(colnames(data_matrimonios_2017) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2018)) { data_matrimonios_2018 <- data_matrimonios_2018[, -which(colnames(data_matrimonios_2018) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2019)) { data_matrimonios_2019 <- data_matrimonios_2019[, -which(colnames(data_matrimonios_2019) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2020)) { data_matrimonios_2020 <- data_matrimonios_2020[, -which(colnames(data_matrimonios_2020) == "NUNUMU")]}

if ("NUNUMU" %in% colnames(data_matrimonios_2021)) { data_matrimonios_2021 <- data_matrimonios_2021[, -which(colnames(data_matrimonios_2021) == "NUNUMU")]}
```

```{r}
if ("AREAG" %in% colnames(data_matrimonios_2010)) { data_matrimonios_2010 <- data_matrimonios_2010[, -which(colnames(data_matrimonios_2010) == "AREAG")]}

if ("AREAG" %in% colnames(data_matrimonios_2011)) { data_matrimonios_2011 <- data_matrimonios_2011[, -which(colnames(data_matrimonios_2011) == "AREAG")]}

if ("AREAG" %in% colnames(data_matrimonios_2012)) { data_matrimonios_2012 <- data_matrimonios_2012[, -which(colnames(data_matrimonios_2012) == "AREAG")]}

if ("AREAGOCU" %in% colnames(data_matrimonios_2013)) { data_matrimonios_2013 <- data_matrimonios_2013[, -which(colnames(data_matrimonios_2013) == "AREAGOCU")]}

if ("AREAGOCU" %in% colnames(data_matrimonios_2014)) { data_matrimonios_2014 <- data_matrimonios_2014[, -which(colnames(data_matrimonios_2014) == "AREAGOCU")]}

if ("AREAGOCU" %in% colnames(data_matrimonios_2015)) { data_matrimonios_2015 <- data_matrimonios_2015[, -which(colnames(data_matrimonios_2015) == "AREAGOCU")]}

if ("AREAGOCU" %in% colnames(data_matrimonios_2016)) { data_matrimonios_2016 <- data_matrimonios_2016[, -which(colnames(data_matrimonios_2016) == "AREAGOCU")]}

if ("AREAGOCU" %in% colnames(data_matrimonios_2017)) { data_matrimonios_2017 <- data_matrimonios_2017[, -which(colnames(data_matrimonios_2017) == "AREAGOCU")]}
```

```{r}

#data_matrimonios_2010$DEPREG

```

```{r}

#data_matrimonios_2011$DEPREG

```

```{r}
#identical(colnames(data_matrimonios_2010), colnames(data_matrimonios_2011))
#identical(ncol(data_matrimonios_2010), ncol(data_matrimonios_2011))

#merged_dataset <- rbind(data_matrimonios_2010, data_matrimonios_2011)

class(data_matrimonios_2016$ESCMUJ)
```

```{r}
data_matrimonios_2010$DEPREG <- as.character(data_matrimonios_2010$DEPREG)
data_matrimonios_2011$DEPREG <- as.character(data_matrimonios_2011$DEPREG)
data_matrimonios_2012$DEPREG <- as.character(data_matrimonios_2012$DEPREG)
data_matrimonios_2013$DEPREG <- as.character(data_matrimonios_2013$DEPREG)
data_matrimonios_2014$DEPREG <- as.character(data_matrimonios_2014$DEPREG)
data_matrimonios_2015$DEPREG <- as.character(data_matrimonios_2015$DEPREG)
data_matrimonios_2016$DEPREG <- as.character(data_matrimonios_2016$DEPREG)
data_matrimonios_2017$DEPREG <- as.character(data_matrimonios_2017$DEPREG)
data_matrimonios_2018$DEPREG <- as.character(data_matrimonios_2018$DEPREG)
data_matrimonios_2019$DEPREG <- as.character(data_matrimonios_2019$DEPREG)
data_matrimonios_2020$DEPREG <- as.character(data_matrimonios_2020$DEPREG)
data_matrimonios_2021$DEPREG <- as.character(data_matrimonios_2021$DEPREG)

data_matrimonios_2010$MUPREG <- as.character(data_matrimonios_2010$MUPREG)
data_matrimonios_2011$MUPREG <- as.character(data_matrimonios_2011$MUPREG)
data_matrimonios_2012$MUPREG <- as.character(data_matrimonios_2012$MUPREG)
data_matrimonios_2013$MUPREG <- as.character(data_matrimonios_2013$MUPREG)
data_matrimonios_2014$MUPREG <- as.character(data_matrimonios_2014$MUPREG)
data_matrimonios_2015$MUPREG <- as.character(data_matrimonios_2015$MUPREG)
data_matrimonios_2016$MUPREG <- as.character(data_matrimonios_2016$MUPREG)
data_matrimonios_2017$MUPREG <- as.character(data_matrimonios_2017$MUPREG)
data_matrimonios_2018$MUPREG <- as.character(data_matrimonios_2018$MUPREG)
data_matrimonios_2019$MUPREG <- as.character(data_matrimonios_2019$MUPREG)
data_matrimonios_2020$MUPREG <- as.character(data_matrimonios_2020$MUPREG)
data_matrimonios_2021$MUPREG <- as.character(data_matrimonios_2021$MUPREG)

data_matrimonios_2010$MESREG <- as.character(data_matrimonios_2010$MESREG)
data_matrimonios_2011$MESREG <- as.character(data_matrimonios_2011$MESREG)
data_matrimonios_2012$MESREG <- as.character(data_matrimonios_2012$MESREG)
data_matrimonios_2013$MESREG <- as.character(data_matrimonios_2013$MESREG)
data_matrimonios_2014$MESREG <- as.character(data_matrimonios_2014$MESREG)
data_matrimonios_2015$MESREG <- as.character(data_matrimonios_2015$MESREG)
data_matrimonios_2016$MESREG <- as.character(data_matrimonios_2016$MESREG)
data_matrimonios_2017$MESREG <- as.character(data_matrimonios_2017$MESREG)
data_matrimonios_2018$MESREG <- as.character(data_matrimonios_2018$MESREG)
data_matrimonios_2019$MESREG <- as.character(data_matrimonios_2019$MESREG)
data_matrimonios_2020$MESREG <- as.character(data_matrimonios_2020$MESREG)
data_matrimonios_2021$MESREG <- as.character(data_matrimonios_2021$MESREG)

data_matrimonios_2010$CLAUNI <- as.character(data_matrimonios_2010$CLAUNI)
data_matrimonios_2011$CLAUNI <- as.character(data_matrimonios_2011$CLAUNI)
data_matrimonios_2012$CLAUNI <- as.character(data_matrimonios_2012$CLAUNI)
data_matrimonios_2013$CLAUNI <- as.character(data_matrimonios_2013$CLAUNI)
data_matrimonios_2014$CLAUNI <- as.character(data_matrimonios_2014$CLAUNI)
data_matrimonios_2015$CLAUNI <- as.character(data_matrimonios_2015$CLAUNI)
data_matrimonios_2016$CLAUNI <- as.character(data_matrimonios_2016$CLAUNI)
data_matrimonios_2017$CLAUNI <- as.character(data_matrimonios_2017$CLAUNI)
data_matrimonios_2018$CLAUNI <- as.character(data_matrimonios_2018$CLAUNI)
data_matrimonios_2019$CLAUNI <- as.character(data_matrimonios_2019$CLAUNI)
data_matrimonios_2020$CLAUNI <- as.character(data_matrimonios_2020$CLAUNI)
data_matrimonios_2021$CLAUNI <- as.character(data_matrimonios_2021$CLAUNI)

data_matrimonios_2010$EDADHOM <- as.double(data_matrimonios_2010$EDADHOM)
data_matrimonios_2011$EDADHOM <- as.double(data_matrimonios_2011$EDADHOM)
data_matrimonios_2012$EDADHOM <- as.double(data_matrimonios_2012$EDADHOM)
data_matrimonios_2013$EDADHOM <- as.double(data_matrimonios_2013$EDADHOM)
data_matrimonios_2014$EDADHOM <- as.double(data_matrimonios_2014$EDADHOM)
data_matrimonios_2015$EDADHOM <- as.double(data_matrimonios_2015$EDADHOM)
data_matrimonios_2016$EDADHOM <- as.double(data_matrimonios_2016$EDADHOM)
data_matrimonios_2017$EDADHOM <- as.double(data_matrimonios_2017$EDADHOM)
data_matrimonios_2018$EDADHOM <- as.double(data_matrimonios_2018$EDADHOM)
data_matrimonios_2019$EDADHOM <- as.double(data_matrimonios_2019$EDADHOM)
data_matrimonios_2020$EDADHOM <- as.double(data_matrimonios_2020$EDADHOM)
data_matrimonios_2021$EDADHOM <- as.double(data_matrimonios_2021$EDADHOM)

data_matrimonios_2010$EDADMUJ <- as.double(data_matrimonios_2010$EDADMUJ)
data_matrimonios_2011$EDADMUJ <- as.double(data_matrimonios_2011$EDADMUJ)
data_matrimonios_2012$EDADMUJ <- as.double(data_matrimonios_2012$EDADMUJ)
data_matrimonios_2013$EDADMUJ <- as.double(data_matrimonios_2013$EDADMUJ)
data_matrimonios_2014$EDADMUJ <- as.double(data_matrimonios_2014$EDADMUJ)
data_matrimonios_2015$EDADMUJ <- as.double(data_matrimonios_2015$EDADMUJ)
data_matrimonios_2016$EDADMUJ <- as.double(data_matrimonios_2016$EDADMUJ)
data_matrimonios_2017$EDADMUJ <- as.double(data_matrimonios_2017$EDADMUJ)
data_matrimonios_2018$EDADMUJ <- as.double(data_matrimonios_2018$EDADMUJ)
data_matrimonios_2019$EDADMUJ <- as.double(data_matrimonios_2019$EDADMUJ)
data_matrimonios_2020$EDADMUJ <- as.double(data_matrimonios_2020$EDADMUJ)
data_matrimonios_2021$EDADMUJ <- as.double(data_matrimonios_2021$EDADMUJ)

data_matrimonios_2010$GETHOM <- as.character(data_matrimonios_2010$GETHOM)
data_matrimonios_2011$GETHOM <- as.character(data_matrimonios_2011$GETHOM)
data_matrimonios_2012$GETHOM <- as.character(data_matrimonios_2012$GETHOM)
data_matrimonios_2013$GETHOM <- as.character(data_matrimonios_2013$GETHOM)
data_matrimonios_2014$GETHOM <- as.character(data_matrimonios_2014$GETHOM)
data_matrimonios_2015$GETHOM <- as.character(data_matrimonios_2015$GETHOM)
data_matrimonios_2016$GETHOM <- as.character(data_matrimonios_2016$GETHOM)
data_matrimonios_2017$GETHOM <- as.character(data_matrimonios_2017$GETHOM)
data_matrimonios_2018$GETHOM <- as.character(data_matrimonios_2018$GETHOM)
data_matrimonios_2019$GETHOM <- as.character(data_matrimonios_2019$GETHOM)
data_matrimonios_2020$GETHOM <- as.character(data_matrimonios_2020$GETHOM)
data_matrimonios_2021$GETHOM <- as.character(data_matrimonios_2021$GETHOM)

data_matrimonios_2010$GETMUJ <- as.character(data_matrimonios_2010$GETMUJ)
data_matrimonios_2011$GETMUJ <- as.character(data_matrimonios_2011$GETMUJ)
data_matrimonios_2012$GETMUJ <- as.character(data_matrimonios_2012$GETMUJ)
data_matrimonios_2013$GETMUJ <- as.character(data_matrimonios_2013$GETMUJ)
data_matrimonios_2014$GETMUJ <- as.character(data_matrimonios_2014$GETMUJ)
data_matrimonios_2015$GETMUJ <- as.character(data_matrimonios_2015$GETMUJ)
data_matrimonios_2016$GETMUJ <- as.character(data_matrimonios_2016$GETMUJ)
data_matrimonios_2017$GETMUJ <- as.character(data_matrimonios_2017$GETMUJ)
data_matrimonios_2018$GETMUJ <- as.character(data_matrimonios_2018$GETMUJ)
data_matrimonios_2019$GETMUJ <- as.character(data_matrimonios_2019$GETMUJ)
data_matrimonios_2020$GETMUJ <- as.character(data_matrimonios_2020$GETMUJ)
data_matrimonios_2021$GETMUJ <- as.character(data_matrimonios_2021$GETMUJ)

data_matrimonios_2010$NACHOM <- as.character(data_matrimonios_2010$NACHOM)
data_matrimonios_2011$NACHOM <- as.character(data_matrimonios_2011$NACHOM)
data_matrimonios_2012$NACHOM <- as.character(data_matrimonios_2012$NACHOM)
data_matrimonios_2013$NACHOM <- as.character(data_matrimonios_2013$NACHOM)
data_matrimonios_2014$NACHOM <- as.character(data_matrimonios_2014$NACHOM)
data_matrimonios_2015$NACHOM <- as.character(data_matrimonios_2015$NACHOM)
data_matrimonios_2016$NACHOM <- as.character(data_matrimonios_2016$NACHOM)
data_matrimonios_2017$NACHOM <- as.character(data_matrimonios_2017$NACHOM)
data_matrimonios_2018$NACHOM <- as.character(data_matrimonios_2018$NACHOM)
data_matrimonios_2019$NACHOM <- as.character(data_matrimonios_2019$NACHOM)
data_matrimonios_2020$NACHOM <- as.character(data_matrimonios_2020$NACHOM)
data_matrimonios_2021$NACHOM <- as.character(data_matrimonios_2021$NACHOM)

data_matrimonios_2010$NACMUJ <- as.character(data_matrimonios_2010$NACMUJ)
data_matrimonios_2011$NACMUJ <- as.character(data_matrimonios_2011$NACMUJ)
data_matrimonios_2012$NACMUJ <- as.character(data_matrimonios_2012$NACMUJ)
data_matrimonios_2013$NACMUJ <- as.character(data_matrimonios_2013$NACMUJ)
data_matrimonios_2014$NACMUJ <- as.character(data_matrimonios_2014$NACMUJ)
data_matrimonios_2015$NACMUJ <- as.character(data_matrimonios_2015$NACMUJ)
data_matrimonios_2016$NACMUJ <- as.character(data_matrimonios_2016$NACMUJ)
data_matrimonios_2017$NACMUJ <- as.character(data_matrimonios_2017$NACMUJ)
data_matrimonios_2018$NACMUJ <- as.character(data_matrimonios_2018$NACMUJ)
data_matrimonios_2019$NACMUJ <- as.character(data_matrimonios_2019$NACMUJ)
data_matrimonios_2020$NACMUJ <- as.character(data_matrimonios_2020$NACMUJ)
data_matrimonios_2021$NACMUJ <- as.character(data_matrimonios_2021$NACMUJ)

data_matrimonios_2010$ESCHOM <- as.character(data_matrimonios_2010$ESCHOM)
data_matrimonios_2011$ESCHOM <- as.character(data_matrimonios_2011$ESCHOM)
data_matrimonios_2012$ESCHOM <- as.character(data_matrimonios_2012$ESCHOM)
data_matrimonios_2013$ESCHOM <- as.character(data_matrimonios_2013$ESCHOM)
data_matrimonios_2014$ESCHOM <- as.character(data_matrimonios_2014$ESCHOM)
data_matrimonios_2015$ESCHOM <- as.character(data_matrimonios_2015$ESCHOM)
data_matrimonios_2016$ESCHOM <- as.character(data_matrimonios_2016$ESCHOM)
data_matrimonios_2017$ESCHOM <- as.character(data_matrimonios_2017$ESCHOM)
data_matrimonios_2018$ESCHOM <- as.character(data_matrimonios_2018$ESCHOM)
data_matrimonios_2019$ESCHOM <- as.character(data_matrimonios_2019$ESCHOM)
data_matrimonios_2020$ESCHOM <- as.character(data_matrimonios_2020$ESCHOM)
data_matrimonios_2021$ESCHOM <- as.character(data_matrimonios_2021$ESCHOM)


data_matrimonios_2010$ESCMUJ <- as.character(data_matrimonios_2010$ESCMUJ)
data_matrimonios_2011$ESCMUJ <- as.character(data_matrimonios_2011$ESCMUJ)
data_matrimonios_2012$ESCMUJ <- as.character(data_matrimonios_2012$ESCMUJ)
data_matrimonios_2013$ESCMUJ <- as.character(data_matrimonios_2013$ESCMUJ)
data_matrimonios_2014$ESCMUJ <- as.character(data_matrimonios_2014$ESCMUJ)
data_matrimonios_2015$ESCMUJ <- as.character(data_matrimonios_2015$ESCMUJ)
data_matrimonios_2016$ESCMUJ <- as.character(data_matrimonios_2016$ESCMUJ)
data_matrimonios_2017$ESCMUJ <- as.character(data_matrimonios_2017$ESCMUJ)
data_matrimonios_2018$ESCMUJ <- as.character(data_matrimonios_2018$ESCMUJ)
data_matrimonios_2019$ESCMUJ <- as.character(data_matrimonios_2019$ESCMUJ)
data_matrimonios_2020$ESCMUJ <- as.character(data_matrimonios_2020$ESCMUJ)
data_matrimonios_2021$ESCMUJ <- as.character(data_matrimonios_2021$ESCMUJ)


data_matrimonios_2010$DEPOCU <- as.character(data_matrimonios_2010$DEPOCU)
data_matrimonios_2011$DEPOCU <- as.character(data_matrimonios_2011$DEPOCU)
data_matrimonios_2012$DEPOCU <- as.character(data_matrimonios_2012$DEPOCU)
data_matrimonios_2013$DEPOCU <- as.character(data_matrimonios_2013$DEPOCU)
data_matrimonios_2014$DEPOCU <- as.character(data_matrimonios_2014$DEPOCU)
data_matrimonios_2015$DEPOCU <- as.character(data_matrimonios_2015$DEPOCU)
data_matrimonios_2016$DEPOCU <- as.character(data_matrimonios_2016$DEPOCU)
data_matrimonios_2017$DEPOCU <- as.character(data_matrimonios_2017$DEPOCU)
data_matrimonios_2018$DEPOCU <- as.character(data_matrimonios_2018$DEPOCU)
data_matrimonios_2019$DEPOCU <- as.character(data_matrimonios_2019$DEPOCU)
data_matrimonios_2020$DEPOCU <- as.character(data_matrimonios_2020$DEPOCU)
data_matrimonios_2021$DEPOCU <- as.character(data_matrimonios_2021$DEPOCU)

data_matrimonios_2010$MUPOCU <- as.character(data_matrimonios_2010$MUPOCU)
data_matrimonios_2011$MUPOCU <- as.character(data_matrimonios_2011$MUPOCU)
data_matrimonios_2012$MUPOCU <- as.character(data_matrimonios_2012$MUPOCU)
data_matrimonios_2013$MUPOCU <- as.character(data_matrimonios_2013$MUPOCU)
data_matrimonios_2014$MUPOCU <- as.character(data_matrimonios_2014$MUPOCU)
data_matrimonios_2015$MUPOCU <- as.character(data_matrimonios_2015$MUPOCU)
data_matrimonios_2016$MUPOCU <- as.character(data_matrimonios_2016$MUPOCU)
data_matrimonios_2017$MUPOCU <- as.character(data_matrimonios_2017$MUPOCU)
data_matrimonios_2018$MUPOCU <- as.character(data_matrimonios_2018$MUPOCU)
data_matrimonios_2019$MUPOCU <- as.character(data_matrimonios_2019$MUPOCU)
data_matrimonios_2020$MUPOCU <- as.character(data_matrimonios_2020$MUPOCU)
data_matrimonios_2021$MUPOCU <- as.character(data_matrimonios_2021$MUPOCU)

data_matrimonios_2010$MESOCU <- as.character(data_matrimonios_2010$MESOCU)
data_matrimonios_2011$MESOCU <- as.character(data_matrimonios_2011$MESOCU)
data_matrimonios_2012$MESOCU <- as.character(data_matrimonios_2012$MESOCU)
data_matrimonios_2013$MESOCU <- as.character(data_matrimonios_2013$MESOCU)
data_matrimonios_2014$MESOCU <- as.character(data_matrimonios_2014$MESOCU)
data_matrimonios_2015$MESOCU <- as.character(data_matrimonios_2015$MESOCU)
data_matrimonios_2016$MESOCU <- as.character(data_matrimonios_2016$MESOCU)
data_matrimonios_2017$MESOCU <- as.character(data_matrimonios_2017$MESOCU)
data_matrimonios_2018$MESOCU <- as.character(data_matrimonios_2018$MESOCU)
data_matrimonios_2019$MESOCU <- as.character(data_matrimonios_2019$MESOCU)
data_matrimonios_2020$MESOCU <- as.character(data_matrimonios_2020$MESOCU)
data_matrimonios_2021$MESOCU <- as.character(data_matrimonios_2021$MESOCU)

merged_dataset <- rbind(data_matrimonios_2010, data_matrimonios_2011, data_matrimonios_2012, data_matrimonios_2013, data_matrimonios_2014, data_matrimonios_2015, data_matrimonios_2016, data_matrimonios_2017, data_matrimonios_2018, data_matrimonios_2019, data_matrimonios_2020, data_matrimonios_2021)

merged_dataset


```

```{r Correlacion de variables numericas}
promedio_edad <- mean(merged_dataset$EDADHOM[merged_dataset$EDADHOM < 18], na.rm = TRUE)
merged_dataset$EDADHOM_temp <- ifelse(merged_dataset$EDADHOM == 999, promedio_edad, merged_dataset$EDADHOM)

promedio_edad <- mean(merged_dataset$EDADMUJ[merged_dataset$EDADMUJ < 18], na.rm = TRUE)
merged_dataset$EDADMUJ_temp <- ifelse(merged_dataset$EDADMUJ == 999, promedio_edad, merged_dataset$EDADMUJ)


plot(merged_dataset$EDADHOM_temp, merged_dataset$EDADMUJ_temp, pch = 19, col = "lightblue")
abline(lm(merged_dataset$EDADMUJ_temp ~ merged_dataset$EDADHOM_temp), col = "green", lwd = 3)

text(paste("Correlación:", round(cor(merged_dataset$EDADHOM_temp, merged_dataset$EDADMUJ_temp), 2)), x = 20, y = 95)

```
La alta correlación entre ambas variables nos permite saber que tanto el hombre como la mujer tienen edades bastante cercanas al momento de casarse. Hay muy pocos puntos atípicos pero los que existen se refieren a que hay una diferencia significativa en la edad.


```{r}
dataframe <- data.frame(
  nombre_cat = c("Menor de edad (mujer)", "Menor de edad (hombre)", "Ambos menores de edad", "Ninguno es menor de edad"),
  categoria = c(sum(merged_dataset$EDADMUJ < 18), sum(merged_dataset$EDADHOM < 18), sum(merged_dataset$EDADMUJ < 18 & merged_dataset$EDADHOM < 18), sum(merged_dataset$EDADMUJ >= 18 & merged_dataset$EDADHOM >= 18)))

ggplot(dataframe, aes(x = nombre_cat, y = categoria, fill = nombre_cat)) +
  geom_bar(stat = "identity", color = "black", width = 0.7) +
  ggtitle("Casamientos por edad y sexo") +
  labs(x = "Categoría", y = "Cantidad") +
  theme_void() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),
        legend.position = "none") +
  geom_text(aes(label = categoria), vjust = 0, size = 4)


```
Claramente se puede notar que en los casos en que hay casamientos en donde solo hay 1 menor de edad, la mayor parte de los casos es una mujer  y en los otros casos se ve considerablemente reducida la cantidad de veces en que el menor de edad es un hombre o ambos son menor de edad.


```{r}
dataframe <- data.frame(
  nivel_educativo = factor(merged_dataset$ESCMUJ[merged_dataset$EDADMUJ < 18], 
  labels = c("Ninguno", "Primaria", "Básica", "Diversificado", "Universitario", "Ignorado")), rep(1, length(merged_dataset$ESCMUJ[merged_dataset$EDADMUJ < 18])))

ggplot(dataframe, aes(x = nivel_educativo, fill = nivel_educativo)) +
  geom_bar() +
  ggtitle("Niveles educativos de menores de edad") +
  labs(x = "Nivel educativo", y = "Cantidad") +
  theme_minimal() +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5)


```
La mayor parte de mujeres menores de edad no tienen educación al momento del matrimonio o apenas tienen el nivel de educación primaria. 




